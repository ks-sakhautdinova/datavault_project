# Data Vault 2.0 Project - dbt Implementation

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É **Data Vault 2.0** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **dbt** –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ SQL Server –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –≤ —Ü–µ–ª–µ–≤—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. 

## –ö–æ–Ω—Ü–µ–ø—Ü–∏—è Data Vault 2.0

**Data Vault 2.0** - —ç—Ç–æ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â –¥–∞–Ω–Ω—ã—Ö. –û—Å–Ω–æ–≤—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö –≥–∏–±–∫–æ—Å—Ç–∏, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º –≤ –±–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è—Ö.

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –æ–ø–∏—Ä–∞–ª–∞—Å—å –Ω–∞ –∫–æ–Ω—Ü–µ–ø—Ü–∏—é Data Vault 2.0, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å Hub, Link –∏ Satellite —Ç–∞–±–ª–∏—Ü–∞–º–∏. 

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
–î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π –Ω–∞–ø–∏—Å–∞–Ω –º–∞–∫—Ä–æ—Å **generate_hash_key** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º MD5 —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
–í Hub —Ç–∞–±–ª–∏—Ü—ã –¥–æ–±–∞–≤–ª—è–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö –∏ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π –∫–ª—é—á 
–î–ª—è Satellite —Ç–∞–±–ª–∏—Ü –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω hash_diff (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∞—Ç—Ä–∏–±—É—Ç–æ–≤
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ç–µ—Å—Ç—ã –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ —Ñ–∞–π–ª—ã schema.yml —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –º–æ–¥–µ–ª–µ–π, –∫–æ–ª–æ–Ω–æ–∫, —Ç–µ—Å—Ç–æ–≤ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–µ–≥–∏ –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –º–æ–¥–µ–ª–µ–π –ø–æ —Å–ª–æ—è–º (staging, hub, link, satellite, raw_vault)

**–í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Å ID –¥–ª—è —Ç—Ä–∞—Å—Å–∏—Ä—É–µ–º–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
–î–æ–±–∞–≤–∏—Ç—å Business Vault —Å–ª–æ–π –¥–ª—è –≥–æ—Ç–æ–≤—ã—Ö –∫ –∞–Ω–∞–ª–∏–∑—É –¥–∞–Ω–Ω—ã—Ö
–†–∞—Å—à–∏—Ä–∏—Ç—å –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏

<img width="781" height="842" alt="–î–∏–∞–≥—Ä–∞–º–º–∞ –±–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è drawio" src="https://github.com/user-attachments/assets/4171a321-dde4-40c9-a955-4e503f9e3875" />


## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Data Vault

Data Vault 2.0 —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ç—Ä—ë—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–ª–æ—ë–≤:

### **1. Staging Layer**
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü–µ—Ä–≤–∏—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é `table`

### **2. Raw Vault Layer**
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –•—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ Data Vault

#### **Hub**
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –•—Ä–∞–Ω—è—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–∫–ª—é—á–∏ —Å—É—â–Ω–æ—Å—Ç–µ–π
- –°–æ–¥–µ—Ä–∂–∞—Ç —Ç–æ–ª—å–∫–æ –±–∏–∑–Ω–µ—Å-–∫–ª—é—á–∏ (ID —Ç–æ–≤–∞—Ä–∞, ID –º–∞–≥–∞–∑–∏–Ω–∞, ID –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞)
- –ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ —á–µ—Ä–µ–∑ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ü—Ä–∏–º–µ—Ä**: `hub_goods` —Å–æ–¥–µ—Ä–∂–∏—Ç `good_id` (–±–∏–∑–Ω–µ—Å-–∫–ª—é—á) –∏ `good_key` (—Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–π –∫–ª—é—á)

#### **Link**
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –°–≤—è–∑—ã–≤–∞—é—Ç Hub —Ç–∞–±–ª–∏—Ü—ã –º–µ–∂–¥—É —Å–æ–±–æ–π
- –°–æ–¥–µ—Ä–∂–∞—Ç —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –∫–ª—é—á–∏ (—Ö–µ—à –æ—Ç –≤—Å–µ—Ö —Å–≤—è–∑–∞–Ω–Ω—ã—Ö Hub)

**–ü—Ä–∏–º–µ—Ä**: `link_sale` —Å–≤—è–∑—ã–≤–∞–µ—Ç —á–µ–∫, –º–∞–≥–∞–∑–∏–Ω, —Ç–æ–≤–∞—Ä –∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞

#### **Satellite**
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –•—Ä–∞–Ω—è—Ç –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã –∏ –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –°—Å—ã–ª–∞—é—Ç—Å—è –Ω–∞ Hub –∏–ª–∏ Link —Ç–∞–±–ª–∏—Ü—ã
- –°–æ–¥–µ—Ä–∂–∞—Ç –≤—Å–µ –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è (–Ω–∞–∑–≤–∞–Ω–∏—è, –∞–¥—Ä–µ—Å–∞, —Ü–µ–Ω—ã)
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π —á–µ—Ä–µ–∑ `hash_diff`
- –û—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –≤–æ –≤—Ä–µ–º–µ–Ω–∏

**–ü—Ä–∏–º–µ—Ä**: `sat_goods` —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞, —Ç–∏–ø, —Ü–µ–Ω–æ–≤—É—é –≥—Ä—É–ø–ø—É

### **3. Business Vault**
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, —Å–ª–æ–π –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –≥–æ—Ç–æ–≤–æ–π –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∏ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
demo_dv_dbt/
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ staging/                    # Staging —Å–ª–æ–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stg_dim_*.sql          # Staging —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stg_fact_*.sql         # Staging —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è —Ñ–∞–∫—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sources.yml            # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ raw_vault/                 # Raw Vault —Å–ª–æ–π
‚îÇ       ‚îú‚îÄ‚îÄ hubs/                  # Hub —Ç–∞–±–ª–∏—Ü—ã
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ hub_*.sql          # Hub –º–æ–¥–µ–ª–∏
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ schema.yml         # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Hub
‚îÇ       ‚îú‚îÄ‚îÄ links/                 # Link —Ç–∞–±–ª–∏—Ü—ã
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ link_*.sql         # Link –º–æ–¥–µ–ª–∏
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ schema.yml         # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Link
‚îÇ       ‚îî‚îÄ‚îÄ satellites/            # Satellite —Ç–∞–±–ª–∏—Ü—ã
‚îÇ           ‚îú‚îÄ‚îÄ sat_*.sql          # Satellite –º–æ–¥–µ–ª–∏
‚îÇ           ‚îî‚îÄ‚îÄ schema.yml         # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Satellite
‚îú‚îÄ‚îÄ macros/                        # dbt –º–∞–∫—Ä–æ—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ generate_hash_key.sql      # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ö–µ—à-–∫–ª—é—á–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ generate_schema_name.sql   # –ö–∞—Å—Ç–æ–º–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ö–µ–º
‚îú‚îÄ‚îÄ dbt_project.yml               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îî‚îÄ‚îÄ profiles.yml                  # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv venv
venv\Scripts\activate  # Windows
# source venv/bin/activate  # Linux/Mac

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ dbt-sqlserver
pip install dbt-sqlserver
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `profiles.yml` –≤ –ø–∞–ø–∫–µ `~/.dbt/`:

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ dbt
dbt debug

```
### 4. –ó–∞–≥—Ä—É–∑–∫–∞ Data Vault (–ø–æ —Å–ª–æ—è–º)

#### **–≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞**
```bash
# –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
dbt run --full-refresh
```

#### **–≠—Ç–∞–ø 2: Staging —Å–ª–æ–π**
```bash
# –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö Staging —Ç–∞–±–ª–∏—Ü
dbt run --select tag:staging

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Staging —Ç–∞–±–ª–∏—Ü
dbt test --select tag:staging
```

#### **–≠—Ç–∞–ø 3: Hub —Ç–∞–±–ª–∏—Ü—ã (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)**
```bash
# –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö Hub —Ç–∞–±–ª–∏—Ü 
dbt run --select tag:hub

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Hub —Ç–∞–±–ª–∏—Ü
dbt test --select tag:hub
```

#### **–≠—Ç–∞–ø 4: Link –∏ Satellite —Ç–∞–±–ª–∏—Ü—ã (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)**
```bash
# –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö Link —Ç–∞–±–ª–∏—Ü 
dbt run --select tag:link

# –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö Satellite —Ç–∞–±–ª–∏—Ü 
dbt run --select tag:satellite

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Link —Ç–∞–±–ª–∏—Ü
dbt test --select tag:link

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Satellite —Ç–∞–±–ª–∏—Ü
dbt test --select tag:satellite
```

#### **–≠—Ç–∞–ø 5: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ Data Vault
dbt test --select tag:raw_vault


## –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

### **Staging —Å–ª–æ–π (6 —Ç–∞–±–ª–∏—Ü)**
- `stg_dim_goodgroups` - –ì—Ä—É–ø–ø—ã —Ç–æ–≤–∞—Ä–æ–≤
- `stg_dim_goods` - –¢–æ–≤–∞—Ä—ã
- `stg_fact_cheques` - –ß–µ–∫–∏
- `stg_dim_suppliers` - –ü–æ—Å—Ç–∞–≤—â–∏–∫–∏
- `stg_dim_stores` - –ú–∞–≥–∞–∑–∏–Ω—ã
- `stg_dim_manufacturers` - –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–∏

### **Hub —Ç–∞–±–ª–∏—Ü—ã (6 —Ç–∞–±–ª–∏—Ü)**
- `hub_goodgroups` - –ë–∏–∑–Ω–µ—Å-–∫–ª—é—á–∏ –≥—Ä—É–ø–ø —Ç–æ–≤–∞—Ä–æ–≤
- `hub_goods` - –ë–∏–∑–Ω–µ—Å-–∫–ª—é—á–∏ —Ç–æ–≤–∞—Ä–æ–≤
- `hub_cheques` - –ë–∏–∑–Ω–µ—Å-–∫–ª—é—á–∏ —á–µ–∫–æ–≤
- `hub_suppliers` - –ë–∏–∑–Ω–µ—Å-–∫–ª—é—á–∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤
- `hub_stores` - –ë–∏–∑–Ω–µ—Å-–∫–ª—é—á–∏ –º–∞–≥–∞–∑–∏–Ω–æ–≤
- `hub_manufacturers` - –ë–∏–∑–Ω–µ—Å-–∫–ª—é—á–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π

### **Link —Ç–∞–±–ª–∏—Ü—ã (4 —Ç–∞–±–ª–∏—Ü—ã)**
- `link_sale` - –°–≤—è–∑—å: —á–µ–∫ ‚Üî –º–∞–≥–∞–∑–∏–Ω ‚Üî —Ç–æ–≤–∞—Ä ‚Üî –ø–æ—Å—Ç–∞–≤—â–∏–∫
- `link_good_manufacturer` - –°–≤—è–∑—å: —Ç–æ–≤–∞—Ä ‚Üî –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å
- `link_good_goodgroup` - –°–≤—è–∑—å: —Ç–æ–≤–∞—Ä ‚Üî –≥—Ä—É–ø–ø–∞ —Ç–æ–≤–∞—Ä–æ–≤
- `link_goodgroup_hierarchy` - –ò–µ—Ä–∞—Ä—Ö–∏—è –≥—Ä—É–ø–ø —Ç–æ–≤–∞—Ä–æ–≤

### **Satellite —Ç–∞–±–ª–∏—Ü—ã (6 —Ç–∞–±–ª–∏—Ü)**
- `sat_suppliers` - –ê—Ç—Ä–∏–±—É—Ç—ã –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤
- `sat_stores` - –ê—Ç—Ä–∏–±—É—Ç—ã –º–∞–≥–∞–∑–∏–Ω–æ–≤
- `sat_manufacturers` - –ê—Ç—Ä–∏–±—É—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π
- `sat_goods` - –ê—Ç—Ä–∏–±—É—Ç—ã —Ç–æ–≤–∞—Ä–æ–≤
- `sat_goodgroups` - –ê—Ç—Ä–∏–±—É—Ç—ã –≥—Ä—É–ø–ø —Ç–æ–≤–∞—Ä–æ–≤
- `sat_sales` - –ê—Ç—Ä–∏–±—É—Ç—ã –ø—Ä–æ–¥–∞–∂

## üîß –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π**
```sql
-- –§–æ—Ä–º—É–ª–∞: HASH(business_key || record_source)
{{ generate_hash_key('good_id', 'OrganicNevaVP') }}
‚Üí HASHBYTES('MD5', CONCAT_WS('||', CAST(good_id AS NVARCHAR(MAX)), 'OrganicNevaVP'))
```

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
dbt list

# –ü—Ä–æ—Å–º–æ—Ç—Ä –º–æ–¥–µ–ª–µ–π –ø–æ —Ç–µ–≥–∞–º
dbt list --select tag:staging
dbt list --select tag:hub
dbt list --select tag:link
dbt list --select tag:satellite

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏
dbt run --select hub_goods

```

